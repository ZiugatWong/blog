---
title: è·¯ç”±å™¨æŠ˜è…¾æ‰‹å†Œ
tags:
  - è·¯ç”±å™¨
date: 2025-09-08 18:24:38
---

ä¹‹å‰ä¸€ç›´åœ¨ç”¨çš„åä¸ºå¤©é™…é€šæµé‡å¡å› ä¸ºä¸å¯æŠ—å› ç´ å¼ºåˆ¶æ¢å¡ï¼Œè€ƒè™‘åˆ°æœ¬èº«æµé‡é™åˆ¶è¶Šæ¥è¶Šå¤šï¼Œæ‰€ä»¥å¹²è„†é‡æ–°ç‰©è‰²ä¸€æ¬¾åˆé€‚çš„å¡ã€‚æˆ‘åœ¨é…·å®‰åˆ·äº†åŠå¤©ï¼Œæœ€ç»ˆå†³å®šæ‹¿ä¸‹ä¸­å…´ V50 è¿™æ¬¾è·¯ç”±ï¼Œå†…ç½®ç”µä¿¡ç§»åŠ¨åŒç½‘ï¼Œåˆ°æ‰‹è¯•äº†è¯•ï¼Œåœ¨æˆ‘å¾…çš„åœ°æ–¹ï¼Œè¿™ä¸¤ä¿¡å·é‚£æ˜¯æ¯”è”é€šå¼ºå¤ªå¤šäº†ï¼Œæˆ‘å½“åœºæŠŠå¤©é™…é€šé…å¥—çš„åä¸ºè·¯ç”±å™¨æŒ‚é±¼å¤„ç†ã€‚

æˆ‘è€ƒè™‘ä¸­å…´ V50 è¿™æ¬¾è·¯ç”±çš„ä¸€å¤§å› ç´ ï¼Œå°±æ˜¯æœ‰å¤§ä½¬ç»™å®ƒåšå·¥å…·ï¼ˆæ­¤å¤„æ„Ÿè°¢ kano å¤§ä½¬çš„ [UFI-TOOLS](https://github.com/kanoqwq/UFI-TOOLS) ï¼‰ï¼Œè¿™ç¯‡åšå®¢çš„è¯ç”Ÿä¹Ÿæ˜¯å› ä¸ºå®é™…ä½¿ç”¨å·¥å…·æ—¶ï¼Œè¸©äº†å¾ˆå¤šå‘ï¼Œéœ€è¦è®°å½•ä¸€ä¸‹é˜²æ­¢å†è¸©ã€‚

## mihomo æ’ä»¶è®¾ç½®

UFI-TOOLS å·¥å…·å†…çš„æ’ä»¶å•†åº—å¸¦äº†å¤§ä½¬è‡ªåˆ¶çš„ mihomo æ’ä»¶ï¼Œç›´æ¥ä¸€é”®å®‰è£…å°±è¡Œäº†ã€‚å®‰è£…å®Œæˆåæˆ‘ç”¨æ’ä»¶é»˜è®¤çš„ mihomo é…ç½®è®¢é˜…è‡ªå·±çš„æœåŠ¡åï¼Œå‘ç° zashboard å·¨å¡æ— æ¯”ï¼Œå®šä½åŸå› å‘ç°æ˜¯é…ç½®é‡Œçš„è§„åˆ™å¤ªå¤šå¤ªç»†ï¼Œé…ä¸Šæˆ‘æœåŠ¡é‡Œçš„å‡ ç™¾å° proxyï¼Œé¡µé¢åŠ è½½çš„ä¸œè¥¿å¤ªå¤šäº†ï¼Œäºæ˜¯æˆ‘åœ¨ mihomo å®˜æ–¹é…ç½®çš„åŸºç¡€ä¸Šï¼Œåˆå¹¶äº†æ’ä»¶é»˜è®¤çš„éƒ¨åˆ†é…ç½®ï¼Œæœ€ç»ˆå¾—åˆ°äº†ä¸‹é¢ç²¾ç®€çš„é…ç½®ã€‚

```yaml
proxy-providers:
  provider1:
    url: "æ”¹æˆè‡ªå·±çš„è®¢é˜…url"
    type: http
    interval: 86400
    health-check: {enable: true,url: "https://www.gstatic.com/generate_204",interval: 300}
    override:
      additional-prefix: "[provider1]"

proxies: 
  - name: "ç›´è¿"
    type: direct
    udp: true

mixed-port: 7890
redir-port: 7891
tproxy-port: 1536
ipv6: true
mode: Rule
allow-lan: true
disable-keep-alive: true
geodata-mode: false
geo-auto-update: true
geo-update-interval: 24
geox-url:
  asn: "https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/GeoLite2-ASN.mmdb"
experimental:
  http-headers:
    request:
      - name: "User-Agent"
        value: "Mozilla/5.0 (Linux; Android 10; K) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Mobile Safari/537.36"
      - name: "Accept-Language"
        value: "en-US,en;q=0.9"
unified-delay: true
tcp-concurrent: true
log-level: silent
find-process-mode: always
global-client-fingerprint: chrome

external-controller: 0.0.0.0:7788
secret: "123456"
external-ui: WebUI/ZashBoard
external-ui-url: "https://github.com/Zephyruso/zashboard/releases/latest/download/dist.zip"
external-controller-cors:
  allow-origins:
    - "*"
  allow-private-network: true

profile:
  store-selected: true
  store-fake-ip: true

sniffer:
  enable: true
  sniff:
    HTTP:
      ports: [80, 8080-8880]
      override-destination: true
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]
  skip-domain:
    - "Mijia Cloud"
    - "+.push.apple.com"

tun:
  enable: true
  stack: mixed
  dns-hijack:
    - "any:53"
    - "tcp://any:53"
  auto-route: true
  auto-redirect: true
  auto-detect-interface: true

dns:
  enable: true
  ipv6: true
  enhanced-mode: fake-ip
  fake-ip-filter:
    - "*"
    - "+.lan"
    - "+.local"
    - "+.market.xiaomi.com"
  default-nameserver:
    - tls://223.5.5.5
    - tls://223.6.6.6
  nameserver:
    - https://doh.pub/dns-query
    - https://dns.alidns.com/dns-query

proxy-groups:

  - name: é»˜è®¤
    type: select
    proxies: [è‡ªåŠ¨é€‰æ‹©,ç›´è¿,é¦™æ¸¯,å°æ¹¾,æ—¥æœ¬,æ–°åŠ å¡,ç¾å›½,å…¶å®ƒåœ°åŒº,å…¨éƒ¨èŠ‚ç‚¹]

  - name: Google
    type: select
    proxies: [é»˜è®¤,é¦™æ¸¯,å°æ¹¾,æ—¥æœ¬,æ–°åŠ å¡,ç¾å›½,å…¶å®ƒåœ°åŒº,å…¨éƒ¨èŠ‚ç‚¹,è‡ªåŠ¨é€‰æ‹©,ç›´è¿]

  - name: Telegram
    type: select
    proxies: [é»˜è®¤,é¦™æ¸¯,å°æ¹¾,æ—¥æœ¬,æ–°åŠ å¡,ç¾å›½,å…¶å®ƒåœ°åŒº,å…¨éƒ¨èŠ‚ç‚¹,è‡ªåŠ¨é€‰æ‹©,ç›´è¿]

  - name: Twitter
    type: select
    proxies: [é»˜è®¤,é¦™æ¸¯,å°æ¹¾,æ—¥æœ¬,æ–°åŠ å¡,ç¾å›½,å…¶å®ƒåœ°åŒº,å…¨éƒ¨èŠ‚ç‚¹,è‡ªåŠ¨é€‰æ‹©,ç›´è¿]

  - name: å“”å“©å“”å“©
    type: select
    proxies: [é»˜è®¤,é¦™æ¸¯,å°æ¹¾,æ—¥æœ¬,æ–°åŠ å¡,ç¾å›½,å…¶å®ƒåœ°åŒº,å…¨éƒ¨èŠ‚ç‚¹,è‡ªåŠ¨é€‰æ‹©,ç›´è¿]

  - name: å·´å“ˆå§†ç‰¹
    type: select
    proxies: [é»˜è®¤,é¦™æ¸¯,å°æ¹¾,æ—¥æœ¬,æ–°åŠ å¡,ç¾å›½,å…¶å®ƒåœ°åŒº,å…¨éƒ¨èŠ‚ç‚¹,è‡ªåŠ¨é€‰æ‹©,ç›´è¿]

  - name: YouTube
    type: select
    proxies: [é»˜è®¤,é¦™æ¸¯,å°æ¹¾,æ—¥æœ¬,æ–°åŠ å¡,ç¾å›½,å…¶å®ƒåœ°åŒº,å…¨éƒ¨èŠ‚ç‚¹,è‡ªåŠ¨é€‰æ‹©,ç›´è¿]

  - name: NETFLIX
    type: select
    proxies: [é»˜è®¤,é¦™æ¸¯,å°æ¹¾,æ—¥æœ¬,æ–°åŠ å¡,ç¾å›½,å…¶å®ƒåœ°åŒº,å…¨éƒ¨èŠ‚ç‚¹,è‡ªåŠ¨é€‰æ‹©,ç›´è¿]

  - name: Spotify
    type: select
    proxies:  [é»˜è®¤,é¦™æ¸¯,å°æ¹¾,æ—¥æœ¬,æ–°åŠ å¡,ç¾å›½,å…¶å®ƒåœ°åŒº,å…¨éƒ¨èŠ‚ç‚¹,è‡ªåŠ¨é€‰æ‹©,ç›´è¿]

  - name: Github
    type: select
    proxies:  [é»˜è®¤,é¦™æ¸¯,å°æ¹¾,æ—¥æœ¬,æ–°åŠ å¡,ç¾å›½,å…¶å®ƒåœ°åŒº,å…¨éƒ¨èŠ‚ç‚¹,è‡ªåŠ¨é€‰æ‹©,ç›´è¿]

  - name: å›½å†…
    type: select
    proxies:  [ç›´è¿,é»˜è®¤,é¦™æ¸¯,å°æ¹¾,æ—¥æœ¬,æ–°åŠ å¡,ç¾å›½,å…¶å®ƒåœ°åŒº,å…¨éƒ¨èŠ‚ç‚¹,è‡ªåŠ¨é€‰æ‹©]

  - name: å…¶ä»–
    type: select
    proxies:  [é»˜è®¤,é¦™æ¸¯,å°æ¹¾,æ—¥æœ¬,æ–°åŠ å¡,ç¾å›½,å…¶å®ƒåœ°åŒº,å…¨éƒ¨èŠ‚ç‚¹,è‡ªåŠ¨é€‰æ‹©,ç›´è¿]

  #åˆ†éš”,ä¸‹é¢æ˜¯åœ°åŒºåˆ†ç»„
  - name: é¦™æ¸¯
    type: select
    include-all: true
    exclude-type: direct
    filter: "(?i)æ¸¯|hk|hongkong|hong kong"

  - name: å°æ¹¾
    type: select
    include-all: true
    exclude-type: direct
    filter: "(?i)å°|tw|taiwan"

  - name: æ—¥æœ¬
    type: select
    include-all: true
    exclude-type: direct
    filter: "(?i)æ—¥|jp|japan"

  - name: ç¾å›½
    type: select
    include-all: true
    exclude-type: direct
    filter: "(?i)ç¾|us|unitedstates|united states"

  - name: æ–°åŠ å¡
    type: select
    include-all: true
    exclude-type: direct
    filter: "(?i)(æ–°|sg|singapore)"

  - name: å…¶å®ƒåœ°åŒº
    type: select
    include-all: true
    exclude-type: direct
    filter: "(?i)^(?!.*(?:ğŸ‡­ğŸ‡°|ğŸ‡¯ğŸ‡µ|ğŸ‡ºğŸ‡¸|ğŸ‡¸ğŸ‡¬|ğŸ‡¨ğŸ‡³|æ¸¯|hk|hongkong|å°|tw|taiwan|æ—¥|jp|japan|æ–°|sg|singapore|ç¾|us|unitedstates)).*"

  - name: å…¨éƒ¨èŠ‚ç‚¹
    type: select
    include-all: true
    exclude-type: direct

  - name: è‡ªåŠ¨é€‰æ‹©
    type: url-test
    include-all: true
    exclude-type: direct
    tolerance: 10

rules:
  - GEOIP,lan,ç›´è¿,no-resolve
  - GEOSITE,github,Github
  - GEOSITE,twitter,Twitter
  - GEOSITE,youtube,YouTube
  - GEOSITE,google,Google
  - GEOSITE,telegram,Telegram
  - GEOSITE,netflix,NETFLIX
  - GEOSITE,bilibili,å“”å“©å“”å“©
  - GEOSITE,bahamut,å·´å“ˆå§†ç‰¹
  - GEOSITE,spotify,Spotify
  - GEOSITE,CN,å›½å†…
  - GEOSITE,geolocation-!cn,å…¶ä»–

  - GEOIP,google,Google
  - GEOIP,netflix,NETFLIX
  - GEOIP,telegram,Telegram
  - GEOIP,twitter,Twitter
  - GEOIP,CN,å›½å†…
  - MATCH,å…¶ä»–

```

## AdGuard Home æ’ä»¶è®¾ç½®

å·¥å…·çš„æ’ä»¶ä»“åº“é‡Œä¹Ÿå¸¦äº† AdGuard Home æ’ä»¶ï¼Œé‚£è‚¯å®šå¾—å¥½å¥½ç”¨èµ·æ¥ï¼Œä¸€é”®å®‰è£…å®Œæˆåï¼Œç›´æ¥åœ¨ [adblockfilters](https://github.com/217heidai/adblockfilters?tab=readme-ov-file) æ‰¾äº†é€‚åˆè‡ªå·±çš„æ‹¦æˆªè§„åˆ™è®¾ç½®åˆ° DNS é»‘åå•é‡Œã€‚

![adguard_dns_block](è·¯ç”±å™¨æŠ˜è…¾æ‰‹å†Œ/adguard_dns_block.png)

## AdGuard å’Œ mihomo çš„ååŒ

åœ¨åŒæ—¶å­˜åœ¨çš„åœºæ™¯ä¸‹ï¼Œè¿™ä¸¤è°éƒ½å¯ä»¥åšå¯¹æ–¹çš„ä¸Šæ¸¸ï¼Œä½†æ˜¯å…ˆç”¨ AdGuard è¿‡æ»¤ï¼Œå†ç”¨ mihomo åˆ†æµï¼Œè¿™æ ·æ˜æ˜¾æ•ˆç‡æ›´é«˜ã€‚æ‰€ä»¥æˆ‘ä»¬è¦å°† mihomo è®¾ç½®ä¸º AdGuard çš„ä¸Šæ¸¸ã€‚

1. è®¾ç½® mihomo ç›‘å¬ 1053 ç«¯å£
  ```yaml
  dns:
    enable: true
    ipv6: true
    listen: 0.0.0.0:1053 # æ–°å¢è¿™è¡Œ
    enhanced-mode: fake-ip
  ```
2. ä¿®æ”¹ AdGuard çš„ DNS ä¸Šæ¸¸ä¸º 192.168.0.1:1053
  ![adguard_dns_upstream](è·¯ç”±å™¨æŠ˜è…¾æ‰‹å†Œ/adguard_dns_upstream.png)
3. æ£€æŸ¥ AdGuard ä¿®æ”¹ç»“æœ
  ![dguard_test](è·¯ç”±å™¨æŠ˜è…¾æ‰‹å†Œ/adguard_test.png)

## git è¿æ¥ github é—®é¢˜

å¼€å¯ mihomo åï¼Œproxy æä¾›å•†å¯èƒ½ä¼šå±è”½ 22 ç«¯å£ï¼Œå¯¼è‡´ git å’Œ github å»ºç«‹ ssh è¿æ¥å¤±è´¥ï¼ŒæŠ¥é”™æç¤ºå¦‚ä¸‹ï¼š

```bash
# git push
wzj@wzj-debian:~/Project/blog$ git push
Connection closed by 198.18.0.252 port 22
fatal: Could not read from remote repository.

Please make sure you have the correct access rights
and the repository exists.

# ssh -vvv git@github.com
wzj@wzj-debian:~/Project/blog$ ssh -vvv git@github.com
debug1: OpenSSH_10.0p2 Debian-7, OpenSSL 3.5.1 1 Jul 2025
debug3: Running on Linux 6.12.43+deb13-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.12.43-1 (2025-08-27) x86_64
debug3: Started with: ssh -vvv git@github.com
...
debug1: Local version string SSH-2.0-OpenSSH_10.0p2 Debian-7
kex_exchange_identification: Connection closed by remote host
Connection closed by 198.18.0.252 port 22

```

æ­¤æ—¶æˆ‘ä»¬å¯ä»¥é€‰æ‹©æ”¹ä¸º 443 ç«¯å£è¿æ¥ï¼Œå‚è€ƒ[githubæä¾›çš„è¯´æ˜](https://docs.github.com/en/authentication/troubleshooting-ssh/using-ssh-over-the-https-port#enabling-ssh-connections-over-https)ï¼Œåœ¨`~/.ssh/config`é‡Œå¢åŠ ä¸‹é¢è¿™éƒ¨åˆ†å³å¯ï¼š

```bash
Host github.com
    Hostname ssh.github.com
    Port 443
    User git
```
